var A=Object.defineProperty;var O=(p,t,i)=>t in p?A(p,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):p[t]=i;var m=(p,t,i)=>O(p,typeof t!="symbol"?t+"":t,i);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))n(e);new MutationObserver(e=>{for(const s of e)if(s.type==="childList")for(const r of s.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&n(r)}).observe(document,{childList:!0,subtree:!0});function i(e){const s={};return e.integrity&&(s.integrity=e.integrity),e.referrerPolicy&&(s.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?s.credentials="include":e.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(e){if(e.ep)return;e.ep=!0;const s=i(e);fetch(e.href,s)}})();const c=class c{constructor(t,i){m(this,"canvas");m(this,"ctx");m(this,"config");m(this,"animationId",null);m(this,"imageData",null);m(this,"started",!1);const n=t.getContext("2d");if(!n)throw new Error("2D canvas context not supported.");this.canvas=t,this.ctx=n,this.config=c.mergeConfig(i),this.canvas.style.display="block",this.canvas.style.width="100%",this.canvas.style.height="100%",this.canvas.style.imageRendering="pixelated",this.handleResize=this.handleResize.bind(this),window.addEventListener("resize",this.handleResize),this.handleResize()}start(){if(this.started)return;this.started=!0;const t=i=>{this.started&&(this.renderFrame(i),this.animationId=window.requestAnimationFrame(t))};this.animationId=window.requestAnimationFrame(t)}stop(){this.started=!1,this.animationId!==null&&(window.cancelAnimationFrame(this.animationId),this.animationId=null),window.removeEventListener("resize",this.handleResize)}updateConfig(t){t.dither&&(this.config.dither={...this.config.dither,...t.dither});const{dither:i,...n}=t;this.config={...this.config,...n,dither:this.config.dither},this.handleResize()}static mergeConfig(t){const i={...this.DEFAULT_CONFIG};if(!t)return i;const n={...i.dither,...t.dither??{}},{dither:e,...s}=t;return{...i,...s,dither:n}}handleResize(){const t=this.canvas.getBoundingClientRect();if(t.width===0||t.height===0)return;const i=this.config.pixelScale<=0?1:this.config.pixelScale,n=Math.max(1,Math.floor(t.width/i)),e=Math.max(1,Math.floor(t.height/i));(this.canvas.width!==n||this.canvas.height!==e)&&(this.canvas.width=n,this.canvas.height=e,this.imageData=this.ctx.createImageData(n,e))}renderFrame(t){if(!this.imageData&&(this.handleResize(),!this.imageData))return;const i=this.canvas.width,n=this.canvas.height,e=this.imageData.data,s=t*.001*this.config.speed,r=this.config.baseHue,l=this.config.hueRange,o=this.config.saturation,u=this.config.lightness,{blobThreshold:f,blobSoftness:b,intensity:d}=this.config,a=(Math.sin(s*2)+1)*.5,g=this.config.hueShiftEnabled?s*this.config.hueShiftSpeed:0;let v=0;for(let h=0;h<n;h++)for(let y=0;y<i;y++){const M=this.computePlasmaValue(y,h,i,n,s,a);let w=0;M>f&&(w=(M-f)/(1-f));const D=Math.max(.01,b);w=Math.pow(w,D);let x=c.clamp(w*d,0,1);x=this.applyDither(x,y,h);const E=(r+l*(x-.5)*2+g)%360,I=x*u,{r:L,g:z,b:F}=c.hslToRgb(E,o,I);e[v++]=L,e[v++]=z,e[v++]=F,e[v++]=255}this.ctx.putImageData(this.imageData,0,0)}computePlasmaValue(t,i,n,e,s,r){const l=t/n,o=i/e,u=l-.5,f=o-.5,b=Math.sqrt(u*u+f*f),d=this.config.plasmaScale;let a=0;return a+=Math.sin(l*10*d+s*1.3),a+=Math.sin(o*10*d-s*1.7),a+=Math.sin((l+o)*8*d+s*.7),a+=Math.sin(b*20*d-s*1.1),a=a*.125+.5,a=a*.7+r*.3,c.clamp(a,0,1)}applyDither(t,i,n){const e=this.config.dither;if(!e.enabled||e.levels<=1)return c.clamp(t,0,1);const s=Math.max(2,Math.floor(e.levels)),r=c.clamp(t,0,1),l=r*s;let o=Math.floor(l);o>=s&&(o=s-1);const u=l-o,b=c.BAYER_4X4[n&3][i&3]/15,d=c.clamp(e.strength,0,1),a=.5*(1-d)+b*d;let g=o;return u>a&&g<s-1&&g++,s<=1?r:g/(s-1)}static clamp(t,i,n){return t<i?i:t>n?n:t}static hslToRgb(t,i,n){const e=(t%360+360)%360/360,s=c.clamp(i,0,1),r=c.clamp(n,0,1);if(s===0){const a=Math.round(r*255);return{r:a,g:a,b:a}}const l=r<.5?r*(1+s):r+s-r*s,o=2*r-l,u=(a,g,v)=>{let h=v;return h<0&&(h+=1),h>1&&(h-=1),h<1/6?a+(g-a)*6*h:h<1/2?g:h<2/3?a+(g-a)*(2/3-h)*6:a},f=u(o,l,e+1/3),b=u(o,l,e),d=u(o,l,e-1/3);return{r:Math.round(f*255),g:Math.round(b*255),b:Math.round(d*255)}}};m(c,"DEFAULT_CONFIG",{baseHue:220,hueRange:120,saturation:.9,lightness:.8,speed:.15,pixelScale:1,plasmaScale:1,blobThreshold:.35,blobSoftness:2,intensity:1,hueShiftEnabled:!1,hueShiftSpeed:40,dither:{enabled:!0,levels:6,strength:1}}),m(c,"BAYER_4X4",[[0,8,2,10],[12,4,14,6],[3,11,1,9],[15,7,13,5]]);let S=c;function T(p,t){return new S(p,t)}const C=document.getElementById("plasma"),R=T(C,{baseHue:143,hueRange:0,saturation:1,lightness:.2,speed:.1,pixelScale:2,plasmaScale:.5,blobThreshold:.25,blobSoftness:2.5,intensity:.7,hueShiftEnabled:!1,hueShiftSpeed:20,dither:{enabled:!0,levels:6,strength:1}});R.start();window.plasma=R;
